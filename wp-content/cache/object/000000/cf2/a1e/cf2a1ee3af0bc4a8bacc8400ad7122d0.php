|‡U<?php exit; ?>a:1:{s:7:"content";O:8:"stdClass":23:{s:2:"ID";s:3:"718";s:11:"post_author";s:1:"1";s:9:"post_date";s:19:"2015-08-14 15:13:59";s:13:"post_date_gmt";s:19:"2015-08-14 09:43:59";s:12:"post_content";s:12428:"Hey friend this tutorial is 5th part of making an e commerce step by step. Today we will add filtering based on price feature.

[button colour="lightblue" type="roundedarrow" size="large" link="http://demo.webtutplus.com/ecomm_part5/" target="_blank"]Try it[/button]
[button colour="lightblue" type="squarearrow" size="large" link="https://github.com/nilmadhab/webtut_ecom_5" target="_blank"]Github repo [/button]
[button colour="lightblue" type="squarearrow" size="large" link="http://demo.webtutplus.com/ecomm_part5.zip" target="_blank"]Download Code[/button]


<span style="text-decoration: underline;"><strong>step 1: Add html form to filter price.</strong></span>
This will go in index.html file just after filtering based on category.
<pre class="lang:default decode:true" title="form in index.html ">&lt;div class="checkbox"&gt;
						      &lt;label&gt;

						      	  	&lt;input type="radio" name="price[]" value="0" 
						      	onChange="this.form.submit()" checked&gt; Below Rs 0-100 
						       
						      &lt;/label&gt; &lt;br /&gt;
						      &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="100" 
						      	onChange="this.form.submit()" &gt; Rs. 100- Rs.500 &lt;br /&gt;
						       
						      &lt;/label&gt; &lt;br /&gt;
						      &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="500" 
						      	onChange="this.form.submit()" &gt; Rs. 500- Rs.1000 &lt;br /&gt;
						       
						      &lt;/label&gt; &lt;br /&gt;
						      &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="1000" 
						      	onChange="this.form.submit()" &gt; Above Rs. 1000 &lt;br /&gt;
						       
						      &lt;/label&gt;
						    &lt;/div&gt;</pre>
<h2><a href="http://webtutplus.com/wp-content/uploads/2015/08/price_1.png"><img class="alignnone size-large wp-image-722" src="http://webtutplus.com/wp-content/uploads/2015/08/price_1-1024x576.png" alt="price_1" width="1024" height="576" /></a></h2>
<h2><strong>step 2:- Lets get the price from url get parameter</strong></h2>
We will get the selected price from url get parameter.
<pre class="lang:default decode:true " title="get price from url">$low = 0;
					$high = 100000;
					if(isset($_GET['price'])){
						$price = $_GET['price'][0];

						if(preg_match("/0/", $price)){
							$low = 0;
							$high = 99;
						}
						if(preg_match("/100/", $price)){
							$low = 100;
							$high = 499;
						}
						if(preg_match("/500/", $price)){
							$low = 500;
							$high = 999;
						}
						if(preg_match("/1000/", $price)){
							$low = 1000;
							$high = 100000;
						}
					}</pre>
Default range is 0 to 100000. If some price range is selected we will change the low and high range accordingly.

Now we just need to change the sql query accordingly.
<pre class="lang:default decode:true " title="sql query">$sql = "SELECT * FROM products WHERE id IN ($products) AND price &gt;= $low 
						AND price &lt;= $high ";</pre>
Thats it. We can filter products now.

We just need to add one more step. If some range is selected we need to show it in the form.
<pre class="lang:default decode:true ">&lt;?php if(isset($_GET['price'])){
						      	$price = $_GET['price'][0];

						      	}else{
						      		$price = -1;
						      		} ?&gt;

						      		&lt;?php if(preg_match("/0/", $price)){ ?&gt;
						      			&lt;input type="radio" name="price[]" value="0" 
						      	onChange="this.form.submit()" checked&gt; Below Rs 0-100 
						       
						      &lt;/label&gt; &lt;br /&gt;
						      		&lt;?php }else{ ?&gt;
						      		&lt;input type="radio" name="price[]" value="0" 
						      	onChange="this.form.submit()" &gt; Below Rs 0-100 
						       
						      &lt;/label&gt; &lt;br /&gt;
						      			&lt;?php } ?&gt;</pre>
Thats it. Now we can filter prices.

<a href="http://webtutplus.com/wp-content/uploads/2015/08/price_2.png"><img class="alignnone size-large wp-image-725" src="http://webtutplus.com/wp-content/uploads/2015/08/price_2-1024x576.png" alt="price_2" width="1024" height="576" /></a>

&nbsp;

I have added discus plugin in demo. Comment there if you have any doubts.

Here is the complete index.php file.
<pre class="lang:default decode:true " title="index.html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;Make Ecommerce part 5&lt;/title&gt;
	 &lt;link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
    rel="stylesheet"&gt;
    &lt;style&gt;
    .image{
    	    border: 1px solid #b2b2b2;
    	   margin: 16px auto 24px;
    	   max-width: 260px;
    	   height: 400px;
    	   margin-left:10px;
    	   overflow: hidden;
    	  
    .tile{
    	max-width: 230px;
    	margin: 0 auto;
    }
    &lt;/style&gt;
    
&lt;/head&gt;
&lt;body&gt;
	&lt;?php include("connect.php") ?&gt;

	&lt;nav class="navbar navbar-inverse navbar-fixed-top"&gt;
	  &lt;div class="container-fluid"&gt;
	    &lt;div class="navbar-header"&gt;
	      &lt;a class="navbar-brand" href="#"&gt;Webtutplus&lt;/a&gt;
	    &lt;/div&gt;
	    &lt;div&gt;
	      &lt;ul class="nav navbar-nav"&gt;
	        &lt;li class="active"&gt;&lt;a href="index.php"&gt;Home&lt;/a&gt;&lt;/li&gt;
	        &lt;li&gt;&lt;a href="admin.php"&gt;Admin panel&lt;/a&gt;&lt;/li&gt;
	       	&lt;li&gt;&lt;a href="admin.php"&gt;Add new product&lt;/a&gt;&lt;/li&gt;
	       	&lt;li&gt;&lt;a href="cart.php"&gt;My Cart&lt;/a&gt;&lt;/li&gt;
	      &lt;/ul&gt;
	    &lt;/div&gt;
	  &lt;/div&gt;
	&lt;/nav&gt;

	&lt;div class="container" style="margin-top:50px" &gt;
		
		&lt;div class="row"&gt;
			&lt;div class="col-sm-3"&gt;
				&lt;h2 class="bg-info"&gt;Category &lt;/h2&gt; 
				&lt;form action="" method="get"&gt;
					&lt;?php
						
					$sql = "SELECT * FROM categories";
					$result = mysqli_query($conn, $sql);
						//&lt;?php
						$cat = array();
						      	if(isset($_GET['cat'])){
						      		print_r($_GET['cat']) ;
						      		$cat = $_GET['cat'];
						      	 
						      	}
						    
					if (mysqli_num_rows($result) &gt; 0) {
					    
					    while($row = mysqli_fetch_assoc($result)) {
					    	?&gt;
					    	&lt;div class="checkbox"&gt;
						      &lt;label&gt;
						      	&lt;!-- check whether checkbox is selected or not --&gt;

						      	&lt;?php 
						      		if(in_array($row['id'], $cat)){
						      			?&gt;
						      			 &lt;input type="checkbox" name="cat[]" value="&lt;?php echo $row['id']; ?&gt;" onChange="this.form.submit()" checked&gt; 
						        	&lt;?php echo $row['name']; ?&gt;
						      			&lt;?php
						      		}else{?&gt;
						      		&lt;input type="checkbox" name="cat[]" value="&lt;?php echo $row['id']; ?&gt;" onChange="this.form.submit()" &gt; 
						        	&lt;?php echo $row['name']; ?&gt;
						      		&lt;?php
						      	}	
						      	?&gt;
						       
						      &lt;/label&gt;
						    &lt;/div&gt;
					    	&lt;?php
					    	
					    }
					} 
					?&gt;
					&lt;h2 class="bg-info"&gt;Price &lt;/h2&gt; 
					&lt;div class="checkbox"&gt;
						      &lt;label&gt;
						      &lt;?php if(isset($_GET['price'])){
						      	$price = $_GET['price'][0];

						      	}else{
						      		$price = -1;
						      		} ?&gt;

						      		&lt;?php if(preg_match("/0/", $price)){ ?&gt;
						      			&lt;input type="radio" name="price[]" value="0" 
						      	onChange="this.form.submit()" checked&gt; Below Rs 0-100 
						       
						      &lt;/label&gt; &lt;br /&gt;
						      		&lt;?php }else{ ?&gt;
						      		&lt;input type="radio" name="price[]" value="0" 
						      	onChange="this.form.submit()" &gt; Below Rs 0-100 
						       
						      &lt;/label&gt; &lt;br /&gt;
						      			&lt;?php } ?&gt;
						      	  	&lt;?php if(preg_match("/100/", $price)){ ?&gt;
						      			&lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="100" 
						      	onChange="this.form.submit()" checked&gt; Rs. 100- Rs.500 &lt;br /&gt;
						       
						      &lt;/label&gt; &lt;br /&gt;
						      		&lt;?php }else{ ?&gt;
						      		&lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="100" 
						      	onChange="this.form.submit()" &gt; Rs. 100- Rs.500 &lt;br /&gt;
						       
						      &lt;/label&gt; &lt;br /&gt;
						      			&lt;?php } ?&gt;
						      			&lt;?php if(preg_match("/500/", $price)){ ?&gt;
						      			 &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="500" 
						      	onChange="this.form.submit()" checked&gt; Rs. 500- Rs.1000 &lt;br /&gt;
						       
						      &lt;/label&gt; &lt;br /&gt;
						      		&lt;?php }else{ ?&gt;
						      		 &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="500" 
						      	onChange="this.form.submit()" &gt; Rs. 500- Rs.1000 &lt;br /&gt;
						       
						      &lt;/label&gt; &lt;br /&gt;
						      			&lt;?php } ?&gt;
						      			&lt;?php if(preg_match("/1000/", $price)){ ?&gt;
						      			 &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="1000" 
						      	onChange="this.form.submit()" checked&gt; Above Rs. 1000 &lt;br /&gt;
						       
						      &lt;/label&gt;
						      		&lt;?php }else{ ?&gt;
						      		 &lt;label&gt;
						      	  	&lt;input type="radio" name="price[]" value="1000" 
						      	onChange="this.form.submit()" &gt; Above Rs. 1000 &lt;br /&gt;
						       
						      &lt;/label&gt;
						      			&lt;?php } ?&gt;
						      
						     
						     
						    &lt;/div&gt;
				&lt;/form&gt;
			&lt;/div&gt;
			&lt;div class="col-sm-9"&gt;
				&lt;?php
					$cat = array();
					$str = "";
					if(isset($_GET['cat'])){
						$cat = $_GET['cat'];
					}
					$low = 0;
					$high = 100000;
					if(isset($_GET['price'])){
						$price = $_GET['price'][0];

						if(preg_match("/0/", $price)){
							$low = 0;
							$high = 99;
						}
						if(preg_match("/100/", $price)){
							$low = 100;
							$high = 499;
						}
						if(preg_match("/500/", $price)){
							$low = 500;
							$high = 999;
						}
						if(preg_match("/1000/", $price)){
							$low = 1000;
							$high = 100000;
						}
					}
					foreach ($cat as $key) {
						$str .= $key.",";
					}
					$str  = rtrim($str,','); // remove the last comma 
					// get all product_id  corrosponding to the checked categories
					$sql = "SELECT * FROM product_cat WHERE categories_id IN ($str)";
					$result = mysqli_query($conn, $sql);
					$products = '';
					if (mysqli_num_rows($result) &gt; 0) {
						while($row = mysqli_fetch_assoc($result)) {
							// get all relevent product ids
							$products .= $row['product_id'].",";

						}
						$products  = rtrim($products,',');
						$sql = "SELECT * FROM products WHERE id IN ($products) AND price &gt;= $low 
						AND price &lt;= $high ";


					}else{
						$sql = "SELECT * FROM products WHERE  price &gt;= $low 
						AND price &lt;= $high";
					}
					echo $sql;
					//$sql = "SELECT * FROM images";
					$result = mysqli_query($conn, $sql);

					if (mysqli_num_rows($result) &gt; 0) {
					    // output data of each row
					    $count = 0;
					    while($row = mysqli_fetch_assoc($result)) {
					    	if($count %3 == 0){
					    		echo '&lt;div class="row" &gt;';
					    	}
					    	
					    	$image = "images/".$row['image_name'];
					        echo '&lt;div class="col-sm-3 image" &gt;';
					        $product_id = $row['id'];
					        echo '&lt;a href="details.php?product_id='.$product_id.'" &gt;
					        	&lt;img src="'.$image.'" class="tile" style="max-width:230px;max-height:250px"
					      		  /&gt;&lt;/a&gt;';
					        echo "&lt;h3&gt;".$row['pname'].'&lt;/h3&gt;';
					       echo '&lt;p&gt;'.'Rs :- '.$row['price']."&lt;/p&gt;";
					        echo '&lt;/div&gt;';


					        if($count %3 == 2){
					    		echo '&lt;/div &gt;';
					    	}
					    	$count +=1;
			         

					    }
					} else {
					    echo "No Products";
					}
					?&gt;
			&lt;/div&gt;
		
		&lt;/div&gt;

	&lt;/div&gt;
	

&lt;/body&gt;
&lt;/html&gt;
</pre>
&nbsp;

&nbsp;";s:10:"post_title";s:44:"E-commerce, part 5, filtering based on price";s:12:"post_excerpt";s:0:"";s:11:"post_status";s:7:"publish";s:14:"comment_status";s:4:"open";s:11:"ping_status";s:4:"open";s:13:"post_password";s:0:"";s:9:"post_name";s:42:"e-commerce-part-5-filtering-based-on-price";s:7:"to_ping";s:0:"";s:6:"pinged";s:0:"";s:13:"post_modified";s:19:"2015-08-22 22:37:37";s:17:"post_modified_gmt";s:19:"2015-08-22 17:07:37";s:21:"post_content_filtered";s:0:"";s:11:"post_parent";s:1:"0";s:4:"guid";s:28:"http://webtutplus.com/?p=718";s:10:"menu_order";s:1:"0";s:9:"post_type";s:4:"post";s:14:"post_mime_type";s:0:"";s:13:"comment_count";s:1:"0";}}